{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst input = document.querySelector('.custom-input');\nconst btn = document.querySelector('.custom-button');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst galleryContainer = document.querySelector('.gallery-container');\nconst loadingOverlay = document.querySelector('.loading-overlay');\nconst API_KEY = '41313291-32cdbbed0c1b146ceb687e8ad';\n\nconst perPage = 40;\nlet currentPage = 1;\nlet searchTerm = '';\nlet totalHits = 0;\n\nasync function serviceGallery(page, search) {\n  const BASE_URL = 'https://pixabay.com/api/';\n\n  const queryParams = new URLSearchParams({\n    key: API_KEY,\n    q: search,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${queryParams}`);\n    return response.data;\n  } catch (error) {\n    throw new Error(error);\n  }\n}\n\nfunction buildApiUrl(searchTerm) {\n  const apiUrl = getBaseUrl();\n  apiUrl.searchParams.append('q', searchTerm);\n  return apiUrl.toString();\n}\n\nfunction galleryMarkup(arr) {\n  const markup = arr\n    .map(\n      image => `\n        <a href=\"${image.largeImageURL}\" class=\"image-card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n          <div class=\"image-info\">\n            <p>Likes: ${image.likes}</p>\n            <p>Views: ${image.views}</p>\n            <p>Comments: ${image.comments}</p>\n            <p>Downloads: ${image.downloads}</p>\n          </div>\n        </a>\n      `\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n\n  const lightbox = new SimpleLightbox('.gallery-container a', {\n    captionsData: 'alt',\n    captionsDelay: 250,\n  });\n  lightbox.refresh();\n}\n\nfunction showError(message) {\n  iziToast.error({\n    title: 'Something wrong',\n    message,\n    position: 'topRight',\n    progressBarColor: 'rgb(255, 0, 0)',\n  });\n}\n\nfunction showInfo(message) {\n  iziToast.info({\n    title: 'Something wrong',\n    message,\n    position: 'topRight',\n    progressBarColor: 'rgb(255, 0, 0)',\n  });\n}\n\nfunction showLoadMoreButton() {\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\n\nfunction showEndOfResultsMessage() {\n  showInfo(\"We're sorry, but you've reached the end of search results.\");\n}\n\nasync function loadMoreImages() {\n  if (\n    loadingOverlay.style.display === 'flex' ||\n    currentPage * perPage >= totalHits\n  ) {\n    return;\n  }\n\n  loadingOverlay.style.display = 'flex';\n\n  currentPage++;\n  try {\n    const images = await serviceGallery(currentPage, searchTerm);\n    if (images.hits && images.hits.length > 0) {\n      galleryMarkup(images.hits);\n      if (images.totalHits > currentPage * perPage) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        showEndOfResultsMessage();\n      }\n    } else {\n      showError('No images found.');\n    }\n  } catch (error) {\n    showError('Error loading more images.');\n  } finally {\n    loadingOverlay.style.display = 'none';\n  }\n}\n\nbtn.addEventListener('click', async () => {\n  searchTerm = input.value.trim();\n  currentPage = 1;\n  totalHits = 0;\n  galleryContainer.innerHTML = '';\n  loadingOverlay.style.display = 'flex';\n\n  try {\n    const images = await serviceGallery(currentPage, searchTerm);\n    if (images.hits && images.hits.length > 0) {\n      galleryMarkup(images.hits);\n      totalHits = images.totalHits;\n      if (images.totalHits > perPage) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n      }\n    } else {\n      showError('No images found.');\n    }\n  } catch (error) {\n    showError('Error searching for images.');\n  } finally {\n    loadingOverlay.style.display = 'none';\n  }\n});\n\nloadMoreBtn.addEventListener('click', loadMoreImages);\n"],"names":["input","btn","loadMoreBtn","galleryContainer","loadingOverlay","API_KEY","perPage","currentPage","searchTerm","totalHits","serviceGallery","page","search","BASE_URL","queryParams","axios","error","galleryMarkup","arr","markup","image","SimpleLightbox","showError","message","iziToast","showInfo","showLoadMoreButton","hideLoadMoreButton","showEndOfResultsMessage","loadMoreImages","images"],"mappings":"owBAMA,MAAMA,EAAQ,SAAS,cAAc,eAAe,EAC9CC,EAAM,SAAS,cAAc,gBAAgB,EAC7CC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAmB,SAAS,cAAc,oBAAoB,EAC9DC,EAAiB,SAAS,cAAc,kBAAkB,EAC1DC,EAAU,qCAEVC,EAAU,GAChB,IAAIC,EAAc,EACdC,EAAa,GACbC,EAAY,EAEhB,eAAeC,EAAeC,EAAMC,EAAQ,CAC1C,MAAMC,EAAW,2BAEXC,EAAc,IAAI,gBAAgB,CACtC,IAAKT,EACL,EAAGO,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMD,EACN,SAAUL,CACd,CAAG,EAED,GAAI,CAEF,OADiB,MAAMS,EAAM,IAAI,GAAGF,KAAYC,GAAa,GAC7C,IACjB,OAAQE,EAAP,CACA,MAAM,IAAI,MAAMA,CAAK,CACtB,CACH,CAQA,SAASC,EAAcC,EAAK,CAC1B,MAAMC,EAASD,EACZ,IACCE,GAAS;AAAA,mBACIA,EAAM;AAAA,sBACHA,EAAM,sBAAsBA,EAAM;AAAA;AAAA,wBAEhCA,EAAM;AAAA,wBACNA,EAAM;AAAA,2BACHA,EAAM;AAAA,4BACLA,EAAM;AAAA;AAAA;AAAA,OAI7B,EACA,KAAK,EAAE,EAEVjB,EAAiB,mBAAmB,YAAagB,CAAM,EAEtC,IAAIE,EAAe,uBAAwB,CAC1D,aAAc,MACd,cAAe,GACnB,CAAG,EACQ,QAAO,CAClB,CAEA,SAASC,EAAUC,EAAS,CAC1BC,EAAS,MAAM,CACb,MAAO,kBACP,QAAAD,EACA,SAAU,WACV,iBAAkB,gBACtB,CAAG,CACH,CAEA,SAASE,EAASF,EAAS,CACzBC,EAAS,KAAK,CACZ,MAAO,kBACP,QAAAD,EACA,SAAU,WACV,iBAAkB,gBACtB,CAAG,CACH,CAEA,SAASG,GAAqB,CAC5BxB,EAAY,MAAM,QAAU,OAC9B,CAEA,SAASyB,GAAqB,CAC5BzB,EAAY,MAAM,QAAU,MAC9B,CAEA,SAAS0B,GAA0B,CACjCH,EAAS,4DAA4D,CACvE,CAEA,eAAeI,GAAiB,CAC9B,GACE,EAAAzB,EAAe,MAAM,UAAY,QACjCG,EAAcD,GAAWG,GAK3B,CAAAL,EAAe,MAAM,QAAU,OAE/BG,IACA,GAAI,CACF,MAAMuB,EAAS,MAAMpB,EAAeH,EAAaC,CAAU,EACvDsB,EAAO,MAAQA,EAAO,KAAK,OAAS,GACtCb,EAAca,EAAO,IAAI,EACrBA,EAAO,UAAYvB,EAAcD,EACnCoB,KAEAC,IACAC,MAGFN,EAAU,kBAAkB,CAE/B,MAAC,CACAA,EAAU,4BAA4B,CAC1C,QAAY,CACRlB,EAAe,MAAM,QAAU,MAChC,EACH,CAEAH,EAAI,iBAAiB,QAAS,SAAY,CACxCO,EAAaR,EAAM,MAAM,OACzBO,EAAc,EACdE,EAAY,EACZN,EAAiB,UAAY,GAC7BC,EAAe,MAAM,QAAU,OAE/B,GAAI,CACF,MAAM0B,EAAS,MAAMpB,EAAeH,EAAaC,CAAU,EACvDsB,EAAO,MAAQA,EAAO,KAAK,OAAS,GACtCb,EAAca,EAAO,IAAI,EACzBrB,EAAYqB,EAAO,UACfA,EAAO,UAAYxB,EACrBoB,IAEAC,KAGFL,EAAU,kBAAkB,CAE/B,MAAC,CACAA,EAAU,6BAA6B,CAC3C,QAAY,CACRlB,EAAe,MAAM,QAAU,MAChC,CACH,CAAC,EAEDF,EAAY,iBAAiB,QAAS2B,CAAc"}